\documentclass[prb,aps]{revtex4}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
% Jean Hare package to translate utf8 character in tex code
\usepackage{packages/utf8ext}
\usepackage[T1]{fontenc}
\usepackage{amsmath, mathtools}
\usepackage{amssymb,amsfonts}
\usepackage{bm}
\usepackage{bbm,upgreek}
\usepackage{graphicx}
\usepackage{packages/quantum} % Jean Hare macros for quantum mechs

\setcounter{MaxMatrixCols}{10}

\newcommand{\tr}[1]{{\vphantom{#1}}^{\mathit t}{#1}}

\parskip = \baselineskip

\begin{document}

\title{Notes on k.p theory for InAs structures}
\date{\today}
 \maketitle


\section{8 Bands Model:}

	\subsection{Bulk Materials}

		{\bf Ref. on HgTe}:  Novik et al. PRB {\bf 72}, 035321 (2005)

		We consider a "quasi-2D" junction (question about validity of 2D here) described by a Kane model involving 8 bands (required to include the hybridization between conduction and valence bands in narrow gap semiconductors). We consider the growth axis to be along z and we note $k_\parallel^2 = k_x^2 + k_y^2$ and $k_+ = k_x + i\,k_y$ and $k_- = k_x - i\,k_y$.

		Basis of states used :

		\begin{eqnarray}
			&& u_1(r) = \kt|Γ_6,+1/2> ; u_2(r) = \kt|Γ_6,-1/2> \\
			&& u_3(r) = \kt|Γ_8,+3/2> ; u_4(r) = \kt|Γ_8,+1/2> ; u_5(r) = \kt|Γ_8,-1/2> ; u_6(r) = \kt|Γ_8,-3/2> \\
			&& u_7(r) = \kt|Γ_7,+1/2> ; u_8(r) = \kt|Γ_7,-1/2>
        \end{eqnarray}

        To symmetrize the P terms we follow (loosely) https://journals.aps.org/prb/pdf/10.1103/PhysRevB.81.235314 taking f = 0.5, which result in simply considering the anti-commutator of $P$ and $k_z$. We cannot simply follow Novik et al. PRB {\bf 72}, 035321 (2005) since in HgTe/HgCdTe hetero structures P is constant through the structure.

		The reduced Hamiltonian reads
		\begin{equation}
		    \renewcommand{\arraystretch}{3.5}
			\label{eq:H0}
			H^0=
			\begin{pmatrix}
				T & 0 &  -\sqrt{\frac12} P k_+  & \sqrt{\frac{1}{6}} \{P, k_z\} &\sqrt{\frac16} P k_- & 0  & -\sqrt{\frac{1}{12}} \{P, k_z\} & -\sqrt{\frac13} P k_-\\
				0 & T & 0 & -\sqrt{\frac16} P k_+ &  \sqrt{\frac{1}{6}} \{P, k_z\} & \sqrt{\frac12} P k- & -\sqrt{\frac13} P k_+ & \sqrt{\frac{1}{12}} \{P, k_z\}\\
				-\sqrt{\frac12}  k_- P & 0 & U+V & -\overline{S}_- & R & 0 & \sqrt{\frac12} \overline{S}_- & -\sqrt{2} R \\
				\sqrt{\frac{1}{6}} \{P, k_z\} & -\sqrt{\frac16} k_- P & - \overline{S}_-^\dagger & U-V & C & R & \sqrt{2} V & -\sqrt{\frac32} \tilde{S}_- \\
				\sqrt{\frac16} k_+ P & \sqrt{\frac{1}{6}} \{P, k_z\} & R^\dagger & C^\dagger & U-V & \overline{S}_+^\dagger & -\sqrt{\frac32} \tilde{S}_+ & -\sqrt{2} V \\
				0 & \sqrt{\frac12} k_+ P & 0 & R^\dagger & \overline{S}_+ & U+V & \sqrt{2} R^\dag & \sqrt{\frac12} \overline{S}_+ \\
				-\sqrt{\frac{1}{12}} \{P, k_z\} & -\sqrt{\frac13} k_- P & \sqrt{\frac12} \overline{S}^{\dag}_- & \sqrt{2} V & -\sqrt{\frac32} \tilde{S}^\dag_+ & \sqrt{2} R & U - Δ & C \\
				-\sqrt{\frac13} k_+ P & \sqrt{\frac{1}{12}} \{P, k_z\} & -\sqrt{2} R^\dag & -\sqrt{\frac32} \tilde{S}_-^\dag & -\sqrt{2} V & \sqrt{\frac12} \overline{S}_+^\dag & C^\dag & U - Δ
			\end{pmatrix}
		\end{equation}

		 where
		 \begin{align}
			 T &= E_c(z) + \frac{ħ^2}{2\,m_0} \left( (2\,F+1) k_\parallel^2 + k_z (2\,F+1) k_z\right)  \\
			 U &= E_v(z) - \frac{ħ^2 }{2\,m_0} \left( γ_1 k_\parallel^2 + k_z γ_1 k_z \right) \\
			 V &=  - \frac{ħ^2 }{2\,m_0} \left( γ_2 k_\parallel^2 -2 k_z γ_2 k_z \right) \\
			R &= - \frac{ħ^2 }{2\,m_0} \sqrt{3} \left( μ\,k_+^2 - \overline{γ} k_-^2 \right) \\
			\overline{S}_\pm &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\pm \Big( \{ γ_3 , k_z \} + [κ , k_z] \Big) \\
			\overline{S}_\pm^\dagger &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\mp \Big( \{ γ_3 , k_z \} - [κ , k_z] \Big) \\
			\tilde{S}_\pm &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\pm \Big( \{ γ_3 , k_z \} - \frac13 [κ , k_z] \Big) \\
			\tilde{S}_\pm^\dagger &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\mp \Big( \{ γ_3 , k_z \} + \frac13 [κ , k_z] \Big) \\
			C &= \frac{ħ^2 }{m_0} k_- [κ , k_z ]\\
			C^\dagger &= -\frac{ħ^2 }{m_0} k_+ [κ , k_z ]  .
		\end{align}

		We choose the unit $nm^{-1}$ for the momenta, $eV$ for the energies, and define the "reduced mass"  $\tilde{m}_0$ such that
		$$
		[eV] =
		\frac{\tilde{k}^2}{2\tilde{m}_0}  =
		\frac{ħ^2 . k^2 }{2 m_0}
		\Rightarrow
		\tilde{m}_0 = \frac{9.109E^{-31} \times 1.6E^{-19}}{(1.055E^{-34})^2 \times 10^{18}} \simeq 13.105
		$$

	In the implementation to be able to go smoothly from a 4 bands to an 8 bands model, we will write the Hamiltonian using the following order: $\kt|Γ_6,+1/2>, \kt|Γ_6,-1/2>, \kt|Γ_8,+1/2>, \kt|Γ_8,-1/2>, \kt|Γ_8,+3/2>, \kt|Γ_8,-3/2>, \kt|Γ_7,+1/2>, \kt|Γ_7,-1/2>$. Which leads to writing the Hamiltonian as follow:
	
		\begin{equation}
		    \renewcommand{\arraystretch}{3.5}
			\label{eq:H0}
			H^0=
			\begin{pmatrix}
				T & 0 &  \sqrt{\frac{1}{6}} \{P, k_z\} &\sqrt{\frac16} P k_- & -\sqrt{\frac12} P k_+  & 0  & -\sqrt{\frac{1}{12}} \{P, k_z\} & -\sqrt{\frac13} P k_-\\
				0 & T & -\sqrt{\frac16} P k_+ &  \sqrt{\frac{1}{6}} \{P, k_z\} & 0 & \sqrt{\frac12} P k- & -\sqrt{\frac13} P k_+ & \sqrt{\frac{1}{12}} \{P, k_z\}\\
				\sqrt{\frac{1}{6}} \{P, k_z\} & -\sqrt{\frac16} k_- P & U-V & C & - \overline{S}_-^\dagger & R & \sqrt{2} V & -\sqrt{\frac32} \tilde{S}_- \\
				\sqrt{\frac16} k_+ P & \sqrt{\frac{1}{6}} \{P, k_z\} & C^\dagger & U-V & R^\dagger & \overline{S}_+^\dagger & -\sqrt{\frac32} \tilde{S}_+ & -\sqrt{2} V \\
				-\sqrt{\frac12}  k_- P & 0 & -\overline{S}_- & R & U+V & 0 & \sqrt{\frac12} \overline{S}_- & -\sqrt{2} R \\
				0 & \sqrt{\frac12} k_+ P & R^\dagger & \overline{S}_+ & 0 & U+V & \sqrt{2} R^\dag & \sqrt{\frac12} \overline{S}_+ \\
				-\sqrt{\frac{1}{12}} \{P, k_z\} & -\sqrt{\frac13} k_- P & \sqrt{2} V & -\sqrt{\frac32} \tilde{S}^\dag_+ & \sqrt{\frac12} \overline{S}^{\dag}_- & \sqrt{2} R & U - Δ & C \\
				-\sqrt{\frac13} k_+ P & \sqrt{\frac{1}{12}} \{P, k_z\} & -\sqrt{\frac32} \tilde{S}_-^\dag & -\sqrt{2} V & -\sqrt{2} R^\dag & \sqrt{\frac12} \overline{S}_+^\dag & C^\dag & U - Δ
			\end{pmatrix}
		\end{equation}
		
Then, we can define two representations of gradient $K_R$ and $K_L$:
		\begin{align}
			(K_Rf)_n = -\frac{i}{a} \left(f_{n+1} - f_n\right)	\\
			(K_Lf)_n = -\frac{i}{a} \left(f_n - f_{n-1}\right)
		\end{align}		
				
		And they form an adjoint pair:
		\begin{align}
			K_L^\dagger = K_R
		\end{align}

The one-sided differences lead to an asymmetry in the structure of this matrix in the diagonal direction, but we will show that this need not break the physical symmetry of the underlying system. There are two possible conventions: to place $K_L$ operators in the lower triangle, or place $K_R$ operators there. Here we take the first one, replace $k_z$ with $K_R$ in the upper triangle, and replace $k_z$ with $K_L$ in the lower triangle. Then we can get:

		\begin{equation}
		    \renewcommand{\arraystretch}{3.5}
			\label{eq:H0}
			H^0=
			\begin{pmatrix}
				T & 0 &  \sqrt{\frac{1}{6}} \{P, K_R\} &\sqrt{\frac16} P k_- & -\sqrt{\frac12} P k_+  & 0  & -\sqrt{\frac{1}{12}} \{P, K_R\} & -\sqrt{\frac13} P k_-\\
				0 & T & -\sqrt{\frac16} P k_+ &  \sqrt{\frac{1}{6}} \{P, K_R\} & 0 & \sqrt{\frac12} P k- & -\sqrt{\frac13} P k_+ & \sqrt{\frac{1}{12}} \{P, K_R\}\\
				\sqrt{\frac{1}{6}} \{P, K_L\} & -\sqrt{\frac16} k_- P & U-V & C_R & - \overline{S}_{R-}^\dagger & R & \sqrt{2} V & -\sqrt{\frac32} \tilde{S}_{R-} \\
				\sqrt{\frac16} k_+ P & \sqrt{\frac{1}{6}} \{P, K_L\} & C_L^\dagger & U-V & R^\dagger & \overline{S}_{R+}^\dagger & -\sqrt{\frac32} \tilde{S}_{R+} & -\sqrt{2} V \\
				-\sqrt{\frac12}  k_- P & 0 & -\overline{S}_{L-} & R & U+V & 0 & \sqrt{\frac12} \overline{S}_{R-} & -\sqrt{2} R \\
				0 & \sqrt{\frac12} k_+ P & R^\dagger & \overline{S}_{L+} & 0 & U+V & \sqrt{2} R^\dag & \sqrt{\frac12} \overline{S}_{R+} \\
				-\sqrt{\frac{1}{12}} \{P, K_L\} & -\sqrt{\frac13} k_- P & \sqrt{2} V & -\sqrt{\frac32} \tilde{S}^\dag_{L+} & \sqrt{\frac12} \overline{S}^{\dag}_{L-} & \sqrt{2} R & U - Δ & C_R \\
				-\sqrt{\frac13} k_+ P & \sqrt{\frac{1}{12}} \{P, K_L\} & -\sqrt{\frac32} \tilde{S}_{L-}^\dag & -\sqrt{2} V & -\sqrt{2} R^\dag & \sqrt{\frac12} \overline{S}_{L+}^\dag & C_L^\dag & U - Δ
			\end{pmatrix}
		\end{equation}
		
		 where
		 \begin{align}
			\overline{S}_{R\pm} &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\pm \Big( \{ γ_3 , K_R \} + [κ , K_R] \Big) \\
			\overline{S}_{L\pm} &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\pm \Big( \{ γ_3 , K_L \} + [κ , K_L] \Big) \\
			\overline{S}_{R\pm}^\dagger &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\mp \Big( \{ γ_3 , K_R \} - [κ , K_R] \Big) \\
			\overline{S}_{L\pm}^\dagger &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\mp \Big( \{ γ_3 , K_L \} - [κ , K_L] \Big) \\
			\tilde{S}_{R\pm} &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\pm \Big( \{ γ_3 , K_R \} - \frac13 [κ , K_R] \Big) \\
			\tilde{S}_{L\pm}^\dagger &= - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\mp \Big( \{ γ_3 , K_L \} + \frac13 [κ , K_L] \Big) \\
			C_R &= \frac{ħ^2 }{m_0} k_- [κ , K_R ]\\
			C_L^\dagger &= -\frac{ħ^2 }{m_0} k_+ [κ , K_L ]  .
		\end{align}
		
		The material dependent parameters are taken from Vurgaftman, I., Meyer, J. R. \& Ram-Mohan, L. R. Band parameters for III–V compound semiconductors and their alloys. Journal of Applied Physics 89, 5815–5875 (2001). When not specified the Luttinger parameter $κ$ is computed using $κ = γ_3 + \frac{2}{3} γ_2 - \frac{1}{3} γ_1 - \frac{2}{3}$ (see \url{https://www.nextnano.de/nextnano3/input_parser/database/binary-zb-default.html}).



	\subsection{Incorporating Strain}

		{\bf Ref.}:
		\begin{enumerate}
			\item Section 2.3 of book by Winkler
			\item Appendix C of Novik et al.
			\item Supplementary of Brüne et al. , PRL {\bf 106}, 126803 (2011)
			\item section IV of Chu et al., PRB {\bf 83}, 075110 (2011).
			\item http://www.iue.tuwien.ac.at/phd/karlowatz/node8.html
		\end{enumerate}

		The Hamiltonian is obtained by the substitution $k_i k_j  \to ϵ_{ij} $ where $ϵ_{ij}$ is the strain tensor and the following replacement :
		\begin{align}
			\frac{ħ^2}{2\,m_0} (2\,F+1) &\to a_c\\
			\frac{ħ^2}{ m_0} γ_1&\to - 2 a_d\\
			\frac{ħ^2}{ m_0} γ_2 &\to -  b\\
			\frac{ħ^2}{ m_0} γ_3&\to - \frac{1}{\sqrt{3}} d
		\end{align}

		Denoting by $a$ the lattice spacing, the define the relative lattice mismatch by
		\begin{equation}
		ϵ = \frac{ a_{\textrm{substrate}} - a_{\textrm{layer}} } {a_{\textrm{layer}}}
		\end{equation}

        For a substrate oriented along (001), we have a strain tensor with only non vanishing components given by
		\begin{align}
			ϵ_{xx} &= ϵ_{yy} = ϵ  ;\\
			ϵ_{zz} &= -2 \frac{C_{12}}{C_{11}} ϵ
		\end{align}
		$C_{12},C_{11}$ are elastic stiffness, with $C_{12}/C_{11}$.

		Brüne et al. give a gap opened by constraint given by
		$E_g = -b (ϵ_{xx} + ϵ_{yy} - 2 ϵ_{zz} )  = -b\,2\left(1 + 2\,\frac{C_{12}}{C_{11}}\right) ϵ$

		From (\ref{eq:H0}), we get the strain Bir-Pikus Hamiltonian
		\begin{equation}
			\label{eq:H-BP}
			H_{BP}=
			\begin{pmatrix}
				T_{BP} & 0 & 0 &0 &0 &0     \\
				0 & T_{BP} & 0 & 0 &0 &0   \\
				0 & 0 & U_{BP}+V_{BP} & -S^-_{BP} & R_{BP} & 0  \\
				0 & 0 & - S_{BP}^+ & U_{BP}-V_{BP} & 0& R_{BP} \\
				0& 0 & R_{BP}^\dagger & 0 & U_{BP}-V_{BP} & (S_{BP}^+)^\dagger \\
				0 & 0 & 0 & R_{BP}^\dagger & S_{BP}^+ & U_{BP}+V_{BP}  \\
			\end{pmatrix}
		\end{equation}
		with
		\begin{align}
			T_{BP} &=  a_c~ \left(  ϵ_{xx} + ϵ_{yy} + ϵ_{zz}  \right)  \\
			U_{BP} &= a_v~ \left(  ϵ_{xx} + ϵ_{yy} + ϵ_{zz}  \right)   \\
			V_{BP} &= \frac{b}{2}~ \left(  ϵ_{xx} + ϵ_{yy} -2  ϵ_{zz}  \right)  \\
			R_{BP} &= - \frac{ħ^2 }{2m_0} \sqrt{3} \left( γ_2( ϵ_{yy} - ϵ_{xx}) + 2 i γ_3  ϵ_{xy} \right) \\
			S^\pm_{BP} &= - \frac{ħ^2 }{2\,m_0} \sqrt{3} γ_3\,2\,(ϵ_{xz} \pm ϵ_{yz} )
		\end{align}

		For the specific case of the (001) constraint, we get
		\begin{align}
			T_{BP} &= a_c~ Tr(ϵ) = a_c \left( 1-\frac{C_{12}}{C_{11}}) \right) 2 ϵ  \\
			U_{BP} &= a_v~ Tr(ϵ) = a_v \left( 1-\frac{C_{12}}{C_{11}}) \right) 2 ϵ    \\
			V_{BP} &= \frac{b}{2}~ \left( ϵ_{xx} + ϵ_{yy} - 2\,ϵ_{zz} \right) = \frac{b}{2}   \left( 1+\frac{C_{12}}{C_{11}})   \right) 2 ϵ   \\
			R_{BP} &= S^\pm_{BP} =0
		\end{align}

		\begin{equation}
			\label{eq:H-BP2}
			H_{BP}=
			\begin{pmatrix}
				T_{BP} & 0 & 0 &0 &0 &0     \\
				0 & T_{BP} & 0 & 0 &0 &0   \\
				0 & 0 & U_{BP}+V_{BP} & 0& 0 & 0  \\
				0 & 0 &0 & U_{BP}-V_{BP} & 0 & 0  \\
				0& 0 & 0& 0 & U_{BP}-V_{BP} &0 \\
				0 & 0 & 0 & 0 & 0 & U_{BP}+V_{BP}
			\end{pmatrix}
		\end{equation}


\section{Numerical Lattice Model:}

    We put the model on a fictitious lattice in the $z$ direction : in $x$ and $y$ directions the model remain continuous. The lattice spacing in this $z$ direction is denoted $a$, and we should focus on $k_z \ll a^{-1}$, irrespective of the condition of applicability of the $k.p$ theory.

    In order to obtain terms that are hermitic, we will use a symmetric expression of the discrete derivative at first order ($\partial_z ϕ \sim \frac{ϕ_{n+1} - ϕ_{n-1}}{2a}$). However to avoid introducing an artificial elementary cell containing two sites, we will derive second order derivative starting from the discrete derivative on the right ($\partial_z ϕ \sim \frac{ϕ_{n+1} - ϕ_{n}}{a}$).

    \subsubsection{$k_z$}

		We replace $k_z ϕ(z) = - i  \partial_{z} ϕ(z)  $ by $Δ_{n} ψ_{n} = -i (ψ_{n+1} - ψ_{n-1})/(2a)$

		which gives in the Hamiltonian:
		\begin{align}
		    h_{n, n+1} &= -\dfrac{i}{2\,a}\\
		    h_{n, n-1} &= \dfrac{i}{2\,a}
		\end{align}


    \subsubsection{$k_z γ(z) k_z$}

		We consider a term of the Hamiltonian the form $k_{z} γ(z) k_{z}$. Let us consider a matrix element of this Hamiltonian :
		\begin{align}
			\mv< ψ | k_{z} γ(z) k_{z} | ϕ >
			&= \int_{z} \overline{ψ}(z) \left( -i \partial_{z}  \right)  γ(z) \left( -i \partial_{z}  \right) ϕ(z)  \\
			&= - \int_{z} \overline{ψ}(z)  \partial_{z}   γ(z)  \partial_{z}  ϕ(z)  \\
			& = + \int_{z}  \left( \partial_{z}\overline{ψ}(z) \right)    γ(z)  \left( \partial_{z}  ϕ(z)  \right)
		\label{eq:discretederivative}
		\end{align}
		At this level, we can check easily the hermiticity of this Hamiltonian term.

		To discretize this term, we start with the final expression (\ref{eq:discretederivative}) and replace:
		$\partial_{z} ϕ(z)  $ by $Δ_{n} ψ_{n} = (ψ_{n+1} - ψ_{n})/a$. We get :
		\begin{align}
			\mv< ψ | k_{z} γ(z) k_{z} | ϕ >
			&=
			\frac{1}{a^2} \sum_{n}
			\left( \overline{ψ}_{n+1} - \overline{ψ}_{n} \right)
			γ_{n}
			\left( ϕ_{n+1} - ϕ_{n} \right)
			\\
			&=
			\frac{1}{a^2} \sum_{n}  \overline{ψ}_{n} \left( γ_{n-1}+γ_{n}\right) ϕ_{n}
			-\frac{1}{a^2} \sum_{n}  \overline{ψ}_{n} γ_{n} ϕ_{n+1}
			-\frac{1}{a^2} \sum_{n}  \overline{ψ}_{n} γ_{n-1} ϕ_{n-1},
		\end{align}
		corresponding to matrix elements of the discretized hamiltonian
		\begin{align}
			h_{n,n} & = \frac{1}{a^2}  \left( γ_{n-1}+γ_{n}\right) \\
			h_{n,n+1} &= - \frac{1}{a^2} γ_{n} \\
			h_{n,n-1} &= - \frac{1}{a^2} γ_{n-1}
		\end{align}

		No derivative of gamma here ! And hermiticity is naturally preserved in this procedure (we treat the ket and the bra on equal footings throughout the procedure).

		\textbf{Note:} If we had used the symmetric expression of the derivative here we would have ended with terms only coupling $n$ and $n\pm2$ which would have resulted in the creation of an artificial sub lattice.


	\subsubsection{$[κ(z),k]$}


		In the calculation of $[\kappa, k_z]$ and $\{\gamma, k_z\}$, we can replace the $k_z$ with $K_R$ and $K_L$. Then we can get:	
		\begin{align}
			\mv< ψ | [κ(z),K_R] | ϕ >
			&= \int_{z} \overline{ψ}(z) \left( κ(z) K_R - K_R κ(z) \right)ϕ(z) \nonumber\\
			&=-\frac{i}{a}\int_{z} \overline{ψ}(z)  κ(z)K_R \left(ϕ(z)\right) -\frac{i}{a}\int_{z} K_L \left(\overline{ψ}(z)\right)  κ(z)ϕ(z) \nonumber\\
			&=-\frac{i}{a}\sum_n \overline{ψ}_n κ_n \left(ϕ_{n+1} - ϕ_{n}\right) -\frac{i}{a}\sum_n \left( \overline{ψ}_{n}-\overline{ψ}_{n-1}\right)κ_nϕ_n \nonumber\\
			&=\frac{i}{a} \sum_n \overline{ψ}_n \left(κ_{n+1}-κ_{n} \right)ϕ_{n+1} 
		\end{align}
		
		hence
		\begin{align}
			h_{n,n+1} &= \frac{i}{a} (κ_{n+1}-κ_{n})
		\end{align}

		\begin{align}
			\mv< ψ | [κ(z),K_L] | ϕ >
			&= \int_{z} \overline{ψ}(z) \left( κ(z) K_L - K_L κ(z) \right)ϕ(z) \nonumber\\
			&=-\frac{i}{a}\int_{z} \overline{ψ}(z)  κ(z)K_L \left(ϕ(z)\right) -\frac{i}{a}\int_{z} K_R \left(\overline{ψ}(z)\right)  κ(z)ϕ(z) \nonumber\\
			&=-\frac{i}{a}\sum_n \overline{ψ}_n κ_n \left(ϕ_{n} - ϕ_{n-1}\right) -\frac{i}{a}\sum_n \left( \overline{ψ}_{n+1}-\overline{ψ}_{n}\right)κ_nϕ_n \nonumber\\
			&=\frac{i}{a} \sum_n \overline{ψ}_n \left(κ_{n-1}-κ_{n} \right)ϕ_{n-1} 
		\end{align}
		
		hence
		\begin{align}
			h_{n,n-1} &= \frac{i}{a} (κ_{n}-κ_{n-1})
		\end{align}



	\subsubsection{$\left\{γ(z),k\right\}$}

		\begin{align}
			\mv< ψ | \left\{γ(z),K_R\right\} | ϕ >
			&=\int_{z} \overline{ψ}(z)  γ(z)(K_R ϕ(z)) - \int_{z} (K_L \left(\overline{ψ}(z)\right)  γ(z)ϕ(z) \nonumber\\
			&=-\frac{i}{a}\sum_n \overline{ψ}_n γ_n \left(ϕ_{n+1} - ϕ_{n}\right) +\frac{i}{a}\sum_n \left( \overline{ψ}_{n}-\overline{ψ}_{n-1}\right)γ_nϕ_n \nonumber\\
			&= \frac{i}{a} \sum_n \overline{ψ}_n \left[2 γ_n ϕ_{n} - \left(γ_n+γ_{n+1}\right)ϕ_{n+1}\right]
		\end{align}

		hence

		\begin{align}
			h_{n,n} &= \frac{2i}{a} γ_{n}\\
			h_{n,n+1} &= -\frac{i}{a} (γ_{n+1}+γ_{n})
		\end{align}



		\begin{align}
			\mv< ψ | \left\{γ(z),K_L\right\} | ϕ >
			&=\int_{z} \overline{ψ}(z)  γ(z)(K_L ϕ(z)) - \int_{z} (K_R \left(\overline{ψ}(z)\right)  γ(z)ϕ(z) \nonumber\\
			&=-\frac{i}{a}\sum_n \overline{ψ}_n γ_n \left(ϕ_{n} - ϕ_{n-1}\right) +\frac{i}{a}\sum_n \left( \overline{ψ}_{n+1}-\overline{ψ}_{n}\right)γ_nϕ_n \nonumber\\
			&= -\frac{i}{a} \sum_n \overline{ψ}_n \left[2 γ_n ϕ_{n} - \left(γ_n+γ_{n-1}\right)ϕ_{n-1}\right]
		\end{align}

		hence

		\begin{align}
			h_{n,n} &= -\frac{2i}{a} γ_{n}\\
			h_{n,n-1} &= \frac{i}{a} (γ_{n-1}+γ_{n})
		\end{align}

	\subsubsection{Discrete Hamiltonian:}


    As a conclusion, the discretized Hamiltonian will take the form of tri-diagonal block matrix. We give below the expression of the main diagonal block and the upper diagonal block:

    \paragraph{Main diagonal:\\}

    \begin{equation}
        \renewcommand{\arraystretch}{3.5}
	    H_{main}[i] =
	    \begin{pmatrix}
			T_0[i] & 0 & \sqrt{\frac23} \frac{i}{a} P &\sqrt{\frac16} P k_- &  -\sqrt{\frac12} P k_+  & 0  & -\sqrt{\frac13}\frac{i}{a} P & -\sqrt{\frac13} P k_-\\
			0 & T_0[i] & -\sqrt{\frac16} P k_+ &  \sqrt{\frac23} \frac{i}{a} P & 0 & \sqrt{\frac12} P k- & -\sqrt{\frac13} P k_+ & \sqrt{\frac13} \frac{i}{a} P\\
			-\sqrt{\frac23} \frac{i}{a} P & -\sqrt{\frac16} k_- P &  U_0[i] - V_0[i] & 0 & - \overline{S}_{R-,0}^ \dagger [i] & R & \sqrt{2} V_0[i] & - \sqrt{\frac32} \tilde{S}_{R-,0}[i] \\
			\sqrt{\frac16} k_+ P & -\sqrt{\frac23} \frac{i}{a} P & 0 & U_0[i] - V_0[i] & R^\dagger & \overline{S}_{R+,0}^\dagger [i] & - \sqrt{\frac32} \tilde{S}_{R+,0}[i] & -\sqrt{2} V_0[i]\\
			-\sqrt{\frac12}  k_- P & 0 & - \overline{S}_{L-,0}[i] & R & U_0[i] + V_0[i] & 0  & \sqrt{\frac12} \overline{S}_{R-,0}[i] & -\sqrt2 R\\
			0 & \sqrt{\frac12} k_+ P & R^\dagger & \overline{S}_{L+,0}[i] & 0 &  U_0[i] + V_0[i] & \sqrt{2} R^\dag & \sqrt{\frac12} \overline{S}_{R+,0}[i] \\
			\sqrt{\frac13} \frac{i}{a} P & -\sqrt{\frac13} k_- P & \sqrt{2} V_0[i] & - \sqrt{\frac32} \tilde{S}_{L+,0}^\dagger [i] & \sqrt{\frac12} \overline{S}_{L-,0}^\dagger [i] & \sqrt2 R & U_0[i] - Δ & 0\\
			-\sqrt{\frac13} k_+ P & -\sqrt{\frac13} \frac{i}{a} P & - \sqrt{\frac32} \tilde{S}_{L-,0}^\dagger [i] & -\sqrt{2} R^\dag & -\sqrt{2} V_0[i] & \sqrt{\frac12} \overline{S}_{L+,0}^\dagger [i] & 0 & U_0[i] - Δ
		\end{pmatrix}
    \end{equation}

    where
	\begin{align}
		 T_0[i] &= E_c[i] + \frac{ħ^2}{2\,m_0} \left( (2\,F + 1) k_\parallel^2 + \dfrac{2\,F[i] + 2\,F[i-1] + 2}{a^2} \right) + T_{BP} \\
		 U_0[i] &= E_v[i] - \frac{ħ^2 }{2\,m_0} \left( γ_1 k_\parallel^2 + \dfrac{γ_1[i] + γ_1[i-1]}{a^2} \right) + U_{BP}\\
		 V_0[i] &=  - \frac{ħ^2}{2\,m_0} \left( γ_2 k_\parallel^2 - 2 \dfrac{γ_2[i] + γ_2[i-1]}{a^2} \right) + V_{BP}\\
		R &= - \frac{ħ^2}{2\,m_0} \sqrt{3} \left( μ\,k_+^2 - \overline{γ} k_-^2 \right)\\
		 \overline{S}_{R\pm,0}[i] &= -\frac{ħ^2}{m_0} \sqrt{3} k_\pm \frac{i}{a} γ_3[i]\\
		 \overline{S}_{L\pm,0}^\dagger[i] &= \frac{ħ^2}{m_0} \sqrt{3} k_\mp \frac{i}{a} γ_3[i] = \overline{S}_{R\pm,0}^*[i]\\
		 \overline{S}_{R\pm,0}^\dagger[i] &= -\frac{ħ^2}{m_0} \sqrt{3} k_\mp \frac{i}{a} γ_3[i]\\
		 \overline{S}_{L\pm,0}[i] &= \frac{ħ^2}{m_0} \sqrt{3} k_\pm \frac{i}{a} γ_3[i] = \overline{S}_{R\pm,0}^{\dagger*}[i]\\
		 \tilde{S}_{R\pm,0} [i] &= -\frac{ħ^2}{m_0} \sqrt{3} k_\pm \frac{i}{a} γ_3[i]\\
		 \tilde{S}_{L\pm,0}^\dagger [i] &= \frac{ħ^2}{m_0} \sqrt{3} k_\mp \frac{i}{a} γ_3[i]=\tilde{S}_{R\pm,0}^* [i]
	\end{align}


	\paragraph{Upper diagonal:\\}
	When computing the contribution of conjugated terms one has to be careful since even if globally the Hamiltonian is hermitian each term independently is not. In particular, we have:

	\begin{align}
	    C_R = \frac{ħ^2 }{m_0} k_- [κ , K_R ] &\rightarrow C[i, i+1] =  \frac{ħ^2}{m_0} k_-\,\dfrac{i}{a}\left(κ[i+1]-κ[i]\right) \\
	    C_L^\dag = - \frac{ħ^2}{m_0} k_+ [κ , K_L] &\rightarrow C^\dag[i, i+1] = 0\\
	    \overline{S}_{R\pm} = -\frac{ħ^2}{2\,m_0} \sqrt{3}  k_\pm \Big( \{ γ_3 , K_R \} + [κ , K_R] \Big) &\rightarrow \overline{S}_{R\pm}[i, i+1] = \frac{ħ^2}{2\,m_0} \sqrt{3}  k_\pm \frac{i}{a} \left(γ_3[i] + γ_3[i+1]-κ[i+1]+κ[i]\right)\\
	    \overline{S}_{R\pm}^\dagger = -\frac{ħ^2}{2\,m_0} \sqrt{3}  k_\mp \Big( \{ γ_3 , K_R \} - [κ , K_R] \Big) &\rightarrow \overline{S}_{R\pm}^\dagger[i, i+1] = \frac{ħ^2}{2\,m_0} \sqrt{3}  k_\mp \frac{i}{a} \left(γ_3[i] + γ_3[i+1]+κ[i+1]-κ[i]\right)\\
	    \overline{S}_{L\pm} = - \frac{ħ^2}{2\,m_0} \sqrt{3}  k_\pm \Big( \{ γ_3 , K_L \} + [κ , K_L] \Big) &\rightarrow \overline{S}^\dag_{L\pm}[i, i+1] = 0\\
	    \overline{S}^\dag_{L\pm} = - \frac{ħ^2}{2\,m_0} \sqrt{3}  k_\mp \Big( \{ γ_3 , K_L \} - [κ , K_L] \Big) &\rightarrow \overline{S}^\dag_{L\pm}[i, i+1] = 0\\
	    \tilde{S}_{R\pm} = - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\pm \Big( \{ γ_3 , K_R \} - \frac13 [κ , K_R] \Big) &\rightarrow \tilde{S}_{R\pm}[i, i+1] = \frac{ħ^2}{2\,m_0} \sqrt{3}  k_\pm \frac{i}{a} \left(γ_3[i] + γ_3[i+1] + \frac13 κ[i+1] - \frac13 κ[i]\right)\\
	    \tilde{S}_{L\pm}^\dag = - \frac{ħ^2 }{2\,m_0} \sqrt{3}  k_\mp \Big( \{ γ_3 , K_L \} + \frac13 [κ , K_L] \Big) &\rightarrow \tilde{S}_{L\pm}^\dag[i, i+1] = 0
	\end{align}

	Paying a close attention to the above one can write:

	\begin{equation}
	    \renewcommand{\arraystretch}{3.5}
	    H_{up} = 
	    \begin{pmatrix}
			T_1[i] & 0 & \sqrt{\frac16} \{P,K_R\} & 0 & 0 & 0 & - \sqrt{\frac{1}{12}} \{P,K_R\} & 0 \\
			0 & T_1[i] & 0 & -\sqrt{\frac16} \{P,K_R\} & 0 & 0 & 0 & \sqrt{\frac{1}{12}} \{P,K_R\}\\
			0 & 0 & U_1[i] - V_1[i] & C_R[i] & -\overline{S}_{R-,1}^\dagger[i] & 0 & \sqrt{2} V_1[i] & -\sqrt{\frac32} \tilde{S}_{R-,1}[i] \\
			0 & 0 & 0 & U_1[i] - V_1[i] & 0 & \overline{S}_{R+,1}^\dagger[i] & -\sqrt{\frac32} \tilde{S}_{R+,1}[i] & -\sqrt{2} V_1[i]\\
			0 & 0 & 0 & 0 & U_1[i] + V_1[i] & 0 & \sqrt{\frac12} \overline{S}_{R-,1}[i] & 0\\
			0 & 0 & 0 & 0 & 0 & U_1[i] + V_1[i] & 0 &  \sqrt{\frac12} \overline{S}_{R+,1}[i]  \\
			0 & 0 & \sqrt{2} V_1[i] & 0 & 0 & 0 & U_1[i] & C_R[i] \\
			0 & 0 & 0 & -\sqrt{2} V_1[i] &  0 & 0 & 0 & U_1[i]
 		\end{pmatrix}
    \end{equation}

    where
	\begin{align}
	    T_1[i] &= - \frac{ħ^2}{2\,m_0} \dfrac{2\,F[i] + 1}{a^2} \\
		U_1[i] &= + \frac{ħ^2 }{2\,m_0} \dfrac{γ_1[i]}{a^2}\\
		V_1[i] &= - \frac{ħ^2 }{2\,m_0} \dfrac{2\,γ_2}{a^2}\\
		\{P,K_R\} &= - \frac{i}{a}\left(P[i]+P[i+1]\right)\\
		\overline{S}_{R\pm,1}[i]
		&= \frac{ħ^2}{2\,m_0} \sqrt{3}  k_\pm \frac{i}{a} \left(γ_3[i] + γ_3[i+1]-κ[i+1]+κ[i]\right)\\
		\overline{S}_{R\pm,1}^\dagger[i]
		&= \frac{ħ^2}{2\,m_0} \sqrt{3}  k_\mp \frac{i}{a} \left(γ_3[i] + γ_3[i+1]+κ[i+1]-κ[i]\right)\\
		\tilde{S}_{R\pm,1}[i]
		&= \frac{ħ^2}{2\,m_0} \sqrt{3}  k_\pm \frac{i}{a} \left(γ_3[i] + γ_3[i+1] + \frac13 κ[i+1] - \frac13 κ[i]\right)\\
		C_R[i] &= \frac{ħ^2}{m_0} k_-\,\dfrac{i}{a}\left(κ[i+1]-κ[i]\right)		
	\end{align}




\section{Parameter interpolation:}

    For quantum wells, one generally does not use pure CdTe as a substrate but an alloy $Hg_xCd_{1-x}Te$. Naively, one may want to use a linear interpolation formula to deduce the parameters of the alloy. However several phenomenological model exist to describe in a more precise manner the parameters of the alloy. In the following we will review them.

    \subsection{$E_g$ and $E_V$:}

        {\bf Ref.}:  Laurenti, J. P. et al. Temperature dependence of the fundamental absorption edge of mercury cadmium telluride. Journal of Applied Physics 67, 6454–6460 (1990).
        {\bf Ref.}:  Hansen, G. L., Schmit, J. L. \& Casselman, T. N. Energy gap versus alloy composition and temperature in Hg1-xCdxTe. Journal of Applied Physics 53, 7099–7101 (1982).


        The gap energy depends both on the temperature and the concentration in non-linear way. Two phenomenological formula have been used to describe it (we do not use the author convention but the one use in the introductory paragraph):
        \begin{align}
            \text{Laurenti}& -0.303\,x + 1.606\,(1-x) + 0.132\,x\,(1-x) + \dfrac{6.3\,x - 3.25\,(1-x) - 5.92\,x\,(1-x)}{11\,x + 78.7\,(1-x) + T}10^{-4\,T^2}\\
            \text{Hansen}& -0.302 + 1.93\,(1-x) + 5.35\,10^{-4}\,T\,(1-2\,(1-x)) -0.810\,(1-x)^2 + 0.832\,(1-x)^3
        \end{align}

        The valence band offset between HgTe and CdTe is taken to be equal to 570 meV at T=0 K, in  agreement  with  recent  experiments (C. R. Becker, V. Latussek, A. Pfeuffer-Jeschke, G. Landwehr, and L. W. Molenkamp, Phys. Rev. B 62, 10353 (2000)). One can assume it varies linearly with the fraction of HgTe (cf Novik et al. PRB {\bf 72}, 035321 (2005), C. K. Shih and W. E. Spicer, Phys. Rev. Lett. 58, 2594 (1987)), or as is done in recent computation in Wuersburg that it should scale like the gap itself:

        \begin{equation}
            E_V(x, T) = E_V(0, 0)\,\frac{E_g(x, T) - E_g(0, T)}{E_g(1, 0) - E_g(0, 0)}
        \end{equation}

    \subsection{$γ_1, γ_2, γ_3, κ$:}

        The dependence of those parameters is mostly linear, however A. Pfeuffer-Jeschke discuss corrections to linearity in thesis. This discussion is simply reproduced (partially) here.

        $γ_1, γ_2, γ_3, κ$ are the parameters of the 8-bands Kane model and can be related to the Luttinger parameters for the valence bands by:
        \begin{align}
            γ_1 &= γ_1^L - \frac13 \dfrac{E_P}{E_g}\\
            γ_2 &= γ_2^L - \frac16 \dfrac{E_P}{E_g}\\
            γ_3 &= γ_3^L - \frac16 \dfrac{E_P}{E_g}\\
            κ &= κ^L - \frac16 \dfrac{E_P}{E_g}\\
        \end{align}

        $γ_1^L, γ_2^L, γ_3^L, κ^L$ are Luttinger parameters and can be related to four other parameters $A$, $H_1, H_2,$ and $G$. The parameter we note $A$ is noted F in A. Pfeuffer thesis.

        \begin{align}
            γ_1^L &= - 1 - \dfrac{2\,m_0}{3\,ħ^2}\left(A + 2\,G + 2\,H_1 + 2\,H_2 \right)\\
            γ_2^L &= - \dfrac{m_0}{3\,ħ^2}\left( A + 2\,G - H_1 - H_2 \right)\\
            γ_3^L &= - \dfrac{m_0}{3\,ħ^2}\left( A - G + H_1 - H_2 \right)\\
            κ^L &= - \dfrac{1}{3} - \dfrac{m_0}{3\,ħ^2}\left( A - G - H_1 + H_2 \right)
        \end{align}

        which can be written:

        \begin{align}
            2\,A + 4\,G + 4\,H_1 + 4\,H_2 &= -\dfrac{3\,ħ^2}{m_0} \left( γ_1^L + 1 \right)\\
            A + 2\,G - H_1 - H_2 &= - \dfrac{3\,ħ^2}{m_0}\,γ_2^L\\
            A - G + H_1 - H_2 &= - \dfrac{3\,ħ^2}{m_0}\,γ_3^L\\
            A - G - H_1 + H_2 &= - \dfrac{3\,ħ^2}{m_0}\left( κ^L + \dfrac{1}{3} \right)
        \end{align}

        Among those parameters only $H_1$ does not have a linear dependence.

        \begin{equation}
            H_1(x) = \dfrac{H_1(0)H_1(1)}{H_1(0)\,x + H_1(1)\,(1-x)}
        \end{equation}

        By combining those relations and the gap dependence on the concentration we can compute the effective parameters to use for an alloy.

\end{document}